<div class="container mt-4">
  <div class="row">
    <div class="col-12">
      <% if @selected_chapter %>
        <h1 class="display-4 text-primary">Ask a Follow-up Question</h1>
        <p class="lead">Continue learning about <%= @selected_chapter.display_name %></p>
      <% else %>
        <h1 class="display-4 text-primary">Ask a Question</h1>
        <p class="lead">Get help with your studies</p>
      <% end %>
    </div>
  </div>

  <div class="row">
    <div class="col-md-8">
      <div class="card">
        <div class="card-body">
          <%= form_with model: @question, local: true do |form| %>
            <% if @question.errors.any? %>
              <div class="alert alert-danger">
                <h4><%= pluralize(@question.errors.count, "error") %> prohibited this question from being saved:</h4>
                <ul>
                  <% @question.errors.full_messages.each do |msg| %>
                    <li><%= msg %></li>
                  <% end %>
                </ul>
              </div>
            <% end %>

            <% if @selected_chapter %>
              <div class="alert alert-info">
                <i class="bi bi-lightbulb"></i>
                <strong>Follow-up Question:</strong> You're asking about <%= @selected_chapter.display_name %>
              </div>
            <% end %>

            <div class="mb-3">
              <%= form.label :content, "Your Question", class: "form-label" %>
              <%= form.text_area :content, class: "form-control", rows: 5, placeholder: @selected_chapter ? "Ask a follow-up question about #{@selected_chapter.name}..." : "Ask your question here..." %>
            </div>

            <div class="mb-3">
              <%= form.label :chapter_id, "Chapter", class: "form-label" %>
              <%= form.collection_select :chapter_id, Chapter.ordered, :id, :display_name, { selected: @question.chapter_id, prompt: "Select a chapter" }, { class: "form-select" } %>
            </div>

            <div class="d-grid gap-2 d-md-flex justify-content-md-start">
              <%= form.submit @selected_chapter ? "Ask Follow-up Question" : "Ask Question", class: "btn btn-primary me-md-2" %>
              <%= link_to "Cancel", questions_path, class: "btn btn-secondary" %>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">Tips for Good Questions</h5>
        </div>
        <div class="card-body">
          <ul class="list-unstyled">
            <li class="mb-2">• Be specific about what you're asking</li>
            <li class="mb-2">• Include relevant context</li>
            <li class="mb-2">• Mention the chapter you're studying</li>
            <li class="mb-2">• Check if your question was already asked</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
